@if (state(); as state) { @if (state.status === 'ready') {
<section class="orders-page section">
  <div class="orders-container">
    <div class="orders-header">
      <h2 class="page-title">I miei ordini</h2>
      <button
        pButton
        icon="pi pi-refresh"
        class="p-button-text p-button-rounded"
        (click)="refresh()"
      ></button>
    </div>

    @if (state.orders.length === 0) {
    <div class="orders-empty">
      <div class="empty-state">
        <div class="empty-icon-wrapper">
          <i class="pi pi-shopping-bag"></i>
        </div>
        <h3>Nessun ordine</h3>
        <p>Non hai ancora effettuato ordini.</p>
        <button
          pButton
          type="button"
          label="Inizia lo shopping"
          class="p-button-primary"
          [routerLink]="['/prodotti']"
        ></button>
      </div>
    </div>
    } @else {
    <div class="orders-list">
      @for (order of state.orders; track order.id) {
      <div class="order-strip">
        <!-- Left: ID & Date -->
        <div class="order-main-info">
          <span class="order-id">#{{ getShortId(order.id) }}</span>
          <span class="order-date"
            >{{ order.createdAt | date: 'dd MMM yyyy' }}</span
          >
        </div>

        <!-- Middle: Status -->
        <div class="order-status-wrapper">
          <span
            class="status-badge"
            [class]="'status-' + statusFor(order.status).tone"
          >
            {{ statusFor(order.status).label }}
          </span>
        </div>

        <!-- Right: Total & Action -->
        <div class="order-summary-action">
          <span class="order-total"
            >{{ order.totalCents / 100 | number: '1.2-2' }} â‚¬</span
          >
          <a [routerLink]="['/ordini', order.id]" class="detail-link">
            Dettagli <i class="pi pi-arrow-right"></i>
          </a>
        </div>
      </div>
      }
    </div>
    }
  </div>
</section>
} @else if (state.status === 'empty') {
<section class="orders-empty section">
  <div class="empty-state">
    <i class="pi pi-inbox"></i>
    <h3>Non hai ancora ordini</h3>
    <p>Quando completerai un acquisto, lo vedrai qui.</p>
    <button pButton type="button" [routerLink]="['/prodotti']">
      Vai al catalogo
    </button>
  </div>
</section>
} @else if (state.status === 'error') {
<section class="orders-empty section">
  <div class="empty-state">
    <i class="pi pi-exclamation-triangle"></i>
    <h3>Non riusciamo a caricare gli ordini</h3>
    <p>Riprova tra poco.</p>
  </div>
</section>
} @else {
<section class="orders-page section">
  <p-card header="I miei ordini" class="orders-card">
    <div class="orders-skeleton">
      @for (row of skeletonRows; track $index) {
      <p-skeleton height="32px"></p-skeleton>
      }
    </div>
  </p-card>
</section>
} }
